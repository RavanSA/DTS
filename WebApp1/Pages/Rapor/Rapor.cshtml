@page
@model WebApp1.Pages.Rapor.RaporModel
@{

    string[] OZET_TABLO = new string[] {"SIRA_NO"
                              ,"CSS_CLASS"
                              ,"TANIM"
                              ,"SAYI"
                              ,"DEGER"
                              };

}


<div class="border container new-case-table" style="padding:30px;">
    <div class="new-case-scroll">
        <form method="get">

            <div class="form-row">
                <div class="form-group col-md-3">
                    @*<label asp-for="Rapor.ilk_tarih">İlk Tarih</label>*@
                    <input type="date" asp-for="ilkTarih" value="@Model.ilkTarih" name="ilkTarih" class="form-control" />
                </div>
                <div class="form-group col-md-3">
                    @*<label asp-for="Rapor.son_tarih">Son Tarih</label>*@
                    <input type="date" value="@Model.sonTarih" asp-for="sonTarih" name="sonTarih" class="form-control" />
                </div>
                <div class="form-group col-md-3">
                    @*<label asp-for="Rapor.lehte">Lehte</label>*@
                    <select class="form-control" value="@Model.lehte" name="lehte">
                        <option value="true" selected>Lehte</option>
                        <option value="false">Aleyhte</option>
                    </select>

                </div>
  
                <div class="form-group col-md-3">
                    <input type="submit" value="Raporla" class="btn btn-dark form-control"
                           asp-route-ilkTarih="@Model.ilkTarih" asp-route-sonTarih="@Model.sonTarih"
                           asp-route-lehte="@Model.lehte"  asp-page-handler="DownloadCSV" />
                </div>
            </div>

            <br />

        </form>

        @if (Model.rapor.Count() > 0)
        {

            <table class="table table-bordered">

                <tr>
                    <th>
                        Tanım
                    </th>
                    <th>
                        Sayı
                    </th>
                    <th>
                        Değer
                    </th>
                </tr>



                @if (Model != null)
                {

                foreach (var Data in Model.rapor)
                {

                if (Model.rapor.First() == Data)
                {

            <div class="form-row">
                <div class="form-group col-md-9">
                    <h3> @Data.TANIM</h3>
                </div>
                <div class="form-group col-md-3">
                    <form method="post">
                        <input type="hidden" asp-for="@Model.ilkTarih" />
                        <input type="hidden" asp-for="@Model.sonTarih" />
                        <input type="hidden" asp-for="@Model.lehte" />
                        <input type="submit" class="btn btn-dark form-control" value="Dosya Oluştur" asp-page-handler="DownloadCSV" />
                    </form>
                </div>
            </div>
                }
                else if (Model.rapor.First() != Data)
                {

                <tbody class="h10">


                    <tr>
                        <td>
                            @Data.TANIM
                        </td>
                        <td>
                            @Data.SAYI
                        </td>
                        <td>
                            @Data.DEGER
                        </td>
                    </tr>

                </tbody>


                }


                }
                }




            </table>

        }
    </div>
</div>